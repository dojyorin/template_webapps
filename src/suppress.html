<!doctype html>
<html lang="ja">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, height=device-height, minimum-scale=1, maximum-scale=1, initial-scale=1, user-scalable=no">
        <meta name="referrer" content="no-referrer">

        <title></title>
    </head>

    <body></body>

    <script async type="module">
        Object.defineProperty(globalThis, "$deepFreeze", {
            enumerable: false,
            configurable: false,
            writable: false,
            value(o){
                Object.freeze(o);

                for(const k of Object.keys(o)){
                    if(!Object.isFrozen(o[k]) && o.hasOwnProperty(k) && typeof o[k] === "object" && o[k] !== null){
                        $deepFreeze(o[k]);
                    }
                }

                return o;
            }
        });

        Object.defineProperty(globalThis, "$deepSeal", {
            enumerable: false,
            configurable: false,
            writable: false,
            value(o){
                Object.seal(o);

                for(const k of Object.keys(o)){
                    if(!Object.isSealed(o[k]) && o.hasOwnProperty(k) && typeof o[k] === "object" && o[k] !== null){
                        $deepSeal(o[k]);
                    }
                }

                return o;
            }
        });

        const freeze = $deepFreeze({
            stage1: {
                stage2: {
                    stage3: true
                }
            }
        });

        const seal = $deepSeal({
            stage1: {
                stage2: {
                    stage3: true
                }
            }
        });

        console.log(freeze);
        console.log(seal);
    </script>
</html>