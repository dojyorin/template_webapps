<!doctype html>
<html>
    <head>
        <meta charset="utf-8">

        <script src="https://cdn.jsdelivr.net/npm/pako@latest/dist/pako.min.js"></script>
    </head>

    <body></body>

    <script async type="module">
        async function deflateEncode(data){
            return new Response(new Blob([data]).stream().pipeThrough(new CompressionStream("deflate"))).arrayBuffer();
        }

        async function deflateDecode(data){
            return new Response(new Blob([data]).stream().pipeThrough(new DecompressionStream("deflate"))).arrayBuffer();
        }

        const sample = new Uint8Array(new Float32Array(16 / 4 * 0x100000).map(() => Math.random()).buffer);

        const encode1 = await deflateEncode(sample);
        const decode1 = await deflateDecode(encode1);
        const encode2 = pako.deflate(sample);
        const decode2 = pako.inflate(encode2);

        console.log("---------- Raw Data ----------");
        console.log(sample);

        console.log("---------- Decoded Data ----------");
        console.log(decode1);
        console.log(decode2);

        console.log("---------- Encoded Data ----------");
        console.log(new Uint8Array(encode1));
        console.log(new Uint8Array(encode2));
    </script>
</html>