<!doctype html>
<meta charset="utf-8">
<meta name="referrer" content="no-referrer">
<meta name="viewport" content="height=device-height,width=device-width,minimum-scale=1,maximum-scale=1,initial-scale=1,user-scalable=no">

<meta name="color-scheme" content="light dark">
<meta name="theme-color" content="#FFFFFF">

<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text x='50%' y='50%' style='dominant-baseline:central;text-anchor:middle;font-size:100px;'>ðŸ“¡</text></svg>">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vuetify@3/dist/vuetify.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@mdi/font@7/css/materialdesignicons.min.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=M+PLUS+1+Code:wght@100;200;300;400;500;600;700">

<script type="importmap">
    {
        "imports": {
            "vue": "https://cdn.jsdelivr.net/npm/vue@3/dist/vue.esm-browser.prod.min.js",
            "vue-router": "https://cdn.jsdelivr.net/npm/vue-router@4/dist/vue-router.esm-browser.min.js",
            "vuex": "https://cdn.jsdelivr.net/npm/vuex@4/dist/vuex.esm-browser.prod.min.js",
            "vuetify": "https://cdn.jsdelivr.net/npm/vuetify@3/dist/vuetify.esm.min.js",
            "@vue/devtools-api": "https://cdn.jsdelivr.net/npm/@vue/devtools-api@6/lib/esm/index.min.js"
        }
    }
</script>

<script async type="module">
    import {createApp, ref, computed, onMounted} from "vue";
    import {createRouter, createWebHashHistory} from "vue-router";
    import {createStore, useStore} from "vuex";
    import {createVuetify, useTheme} from "vuetify";

    const sfc_component_notify = {
        template: /*html*/`
            <v-snackbar position="fixed" location="top" :color="color" v-model="model">
                <slot></slot>

                <template #actions>
                    <v-btn ripple density="comfortable" icon="mdi-close" @click="model = false"></v-btn>
                </template>
            </v-snackbar>
        `,
        props: ["modelValue", "color", "icon"],
        emits: ["update:modelValue"],
        setup(props, context){
            const model = computed({
                get: () => props.modelValue,
                set: v => context.emit("update:modelValue", v)
            });

            return {model};
        }
    };

    const sfc_layout_header = {
        template: /*html*/`
            <v-app-bar density="compact" color="primary">
                <template #prepend>
                    <v-app-bar-nav-icon @click="nav = !nav"></v-app-bar-nav-icon>
                </template>

                <v-app-bar-title>Application</v-app-bar-title>

                <template #append>
                    <v-btn icon="mdi-theme-light-dark" @click="switchDark"></v-btn>
                </template>
            </v-app-bar>
        `,
        props: ["nav"],
        emits: ["update:nav"],
        setup(props, context){
            const theme = useTheme();

            const nav = computed({
                get: () => props.nav,
                set: v => context.emit("update:nav", v)
            });

            function switchDark(){
                theme.global.name.value = theme.global.name.value === "main-light" ? "dark" : "main-light";
            }

            return {nav, switchDark};
        }
    };

    const sfc_layout_footer = {
        template: /*html*/`
            <v-footer app color="primary">
                <v-row no-gutters justify="center">footer</v-row>
            </v-footer>
        `
    };

    const sfc_layout_navigation = {
        template: /*html*/`
            <v-navigation-drawer floating temporary v-model="nav">
                <template #prepend>
                    <v-toolbar density="compact" color="primary">
                        <v-btn icon="mdi-close" @click="nav = false"></v-btn>
                    </v-toolbar>
                </template>

                <v-list>
                    <v-list-item to="/">
                        <v-list-item-title>Home</v-list-item-title>
                    </v-list-item>

                    <v-list-item to="/sub">
                        <v-list-item-title>Sub</v-list-item-title>
                    </v-list-item>
                </v-list>
            </v-navigation-drawer>
        `,
        props: ["nav"],
        emits: ["update:nav"],
        setup(props, context){
            const nav = computed({
                get: () => props.nav,
                set: v => context.emit("update:nav", v)
            });

            return {nav};
        }
    };

    const sfc_main = {
        template: /*html*/`
            <v-app>
                <v-overlay persistent no-click-animation class="justify-center align-center" v-model="loading">
                    <v-progress-circular indeterminate size="60" width="4" color="primary"></v-progress-circular>
                </v-overlay>

                <x-navigation v-model:nav="nav"></x-navigation>

                <x-header v-model:nav="nav"></x-header>

                <v-main>
                    <router-view></router-view>
                </v-main>

                <x-footer></x-footer>
            </v-app>
        `,
        components: {
            "x-header": sfc_layout_header,
            "x-footer": sfc_layout_footer,
            "x-navigation": sfc_layout_navigation
        },
        setup(){
            const store = useStore();

            const loading = computed({
                get: () => store.getters.loading,
                set: v => store.commit("loading", v)
            });

            const nav = ref(false);

            onMounted(()=>{
                store.commit("loading", false);
            });

            return {loading, nav};
        }
    };

    const sfc_page_index = {
        template: /*html*/`
            <v-container fluid>
                <v-row justify="center">
                    <v-btn to="/sub">to /sub</v-btn>
                </v-row>

                <v-row justify="center">
                    <v-col cols sm="6">
                        <v-card>
                            <v-card-title class="text-center">{{count}} : {{countx}}</v-card-title>
                            <v-card-actions class="justify-center">
                                <v-btn @click="increment">Increment</v-btn>
                                <v-btn @click="incrementx">IncrementX</v-btn>
                            </v-card-actions>
                        </v-card>
                    </v-col>
                </v-row>
            </v-container>
        `,
        setup(){
            const store = useStore();

            const count = ref(0);
            const countx = computed(() => store.getters.count);

            function increment(){
                count.value++;
            }

            function incrementx(){
                store.commit("increment");
            }

            return {count, countx, increment, incrementx};
        }
    };

    const sfc_page_sub = {
        template: /*html*/`
            <v-container fluid>
                <v-row justify="center">
                    <v-btn to="/">to /</v-btn>
                </v-row>

                <v-row justify="center">
                    <v-col cols sm="6">
                        <v-card>
                            <v-card-title class="text-center">{{countx}}</v-card-title>
                            <v-card-actions class="justify-center">
                                <v-btn @click="resetx">ResetX</v-btn>
                            </v-card-actions>
                        </v-card>
                    </v-col>
                </v-row>
            </v-container>
        `,
        setup(){
            const store = useStore();

            const countx = computed(() => store.getters.count);

            function resetx(){
                store.commit("reset");
            }

            return {countx, resetx};
        }
    };

    const sfc_page_404 = {
        template: /*html*/`
            <v-row no-gutters justify="center" class="fill-height align-center text-h4">Page Not Found ...</v-row>
        `
    };

    const route = createRouter({
        history: createWebHashHistory(),
        routes: [{
            path: "/",
            component: sfc_page_index
        }, {
            path: "/sub",
            component: sfc_page_sub
        }, {
            path: "/:catchAll(.*)",
            component: sfc_page_404
        }]
    });

    const store = createStore({
        state(){
            return {
                count: 0,
                loading: true
            };
        },

        getters: {
            count(s){
                return s.count;
            },
            loading(s){
                return s.loading;
            }
        },

        mutations: {
            increment(s){
                s.count++;
            },
            reset(s){
                s.count = 0;
            },
            loading(s, v){
                s.loading = v;
            }
        }
    });

    const vuetify = createVuetify({
        theme: {
            defaultTheme: "main-light",
            themes: {
                "main-light": {
                    dark: false,
                    colors: {
                        primary: "#03A9F4",
                        secondary: "#9C27B0",
                        surface: "#FFFFFF",
                        background: "#FFFFFF",
                        info: "#2196F3",
                        success: "#4CAF50",
                        warning: "#FFC107",
                        error: "#FF5252"
                    }
                }
            }
        }
    });

    const component = ((components)=>{
        return {
            install(vue){
                for(const [k, v] of Object.entries(components)){
                    vue.component(k, v);
                }
            }
        };
    })({
        "x-notify": sfc_component_notify
    });

    const vue = createApp(sfc_main);

    vue.use(route);
    vue.use(store);
    vue.use(vuetify);
    vue.use(component);

    vue.mount("#vue");
</script>

<style>
    ::-webkit-scrollbar {
        display: none !important;
    }

    :focus {
        outline: none !important;
    }

    * {
        font-family: "M PLUS 1 Code" !important;
    }

    .v-btn {
        text-transform: none !important;
        letter-spacing: normal !important;
        text-indent: 0 !important;
    }
</style>

<title>Application</title>

<div id="vue"></div>