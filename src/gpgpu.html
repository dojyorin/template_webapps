<!doctype html>
<meta charset="utf-8">

<script src="https://cdn.jsdelivr.net/npm/gpu.js@latest/dist/gpu-browser.min.js"></script>

<script async type="module">
    const gpu = new GPU({
        canvas: new OffscreenCanvas(1, 1),
        mode: "webgl2"
    });

    const kernel = gpu.createKernel(function(a, b){
        return a[this.thread.x] * b[this.thread.y];
    }, {
        output: [2048, 2048]
    });

    const sample = new Float32Array(0x01000000).map(() => Math.random());

    const result = kernel(sample, sample);
    console.log(result);
</script>

<main></main>