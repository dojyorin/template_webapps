<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
    </head>

    <body></body>

    <script async type="module">
        /**
        * @param {Uint8Array} data;
        * @param {TransformStream<Uint8Array,Uint8Array>} ts;
        * @returns {Uint8Array};
        **/
        async function transform(data, ts){
            return new Uint8Array(await new Response(new Blob([data]).stream().pipeThrough(ts)).arrayBuffer());
        }

        /**
        * @param {Uint8Array} data;
        * @returns {Uint8Array};
        **/
        async function deflateEncode(data){
            return await transform(data, new CompressionStream("deflate-raw"));
        }

        /**
        * @param {Uint8Array} data;
        * @returns {Uint8Array};
        **/
        async function deflateDecode(data){
            return await transform(data, new DecompressionStream("deflate-raw"));
        }

        const sample = new Uint8Array(new Float32Array(0x00400000).map(() => Math.random()).buffer);

        const encode = await deflateEncode(sample);
        const decode = await deflateDecode(encode);

        console.log("---------- Sample Data ----------");
        console.log(sample);

        console.log("---------- Decoded Data ----------");
        console.log(decode);

        console.log("---------- Encoded Data ----------");
        console.log(encode);
    </script>
</html>