<!doctype html>
<html lang="ja">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no">
        <meta name="referrer" content="no-referrer">

        <title>Ajax</title>
    </head>

    <body>
        Ajax
    </body>

    <script async type="module">
        async function fetchEx(path, option){
            return (await fetch(Object.entries(option?.params ?? {}).reduce((url, [key, value])=>{
                url.searchParams.append(key, value);
                return url;
            }, new URL(path)), {
                headers: Object.entries(option?.headers ?? {}).reduce((header, [key, value])=>{
                    header.append(key, value);
                    return header;
                }, new Headers()),
                method: option?.method ?? "get",
                mode: option?.mode ?? "cors",
                cache: option?.cache ?? "no-cache",
                credential: option?.credential ?? "omit",
                referrerPolicy: option?.referrerPolicy ?? "no-referrer",
                referrer: option?.referrer ?? "",
                redirect: option?.redirect ?? "follow",
                keepalive: option?.keepalive ?? false,
                integrity: option?.integrity ?? "",
                body: option?.body ?? null
            }))[option?.type ?? "json"]();
        }

        const response = await fetchEx("http://worldclockapi.com/api/json/utc/now");
        console.log(response);
    </script>
</html>